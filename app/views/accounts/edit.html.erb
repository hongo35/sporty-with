<div class="row">
  <div class="col-lg-12">
    <div id="accountFormHeader">
      <h4>アカウント情報の更新</h4>
    </div>
  </div>
</div>

<%= form_for @account, html: {class: 'form-horizontal', multipart: true} do |f| %>
<div id="accountImage" class="row">
  <div class="col-lg-12">
    <%= f.hidden_field :img_cache %>
    <%= image_with_dummy(@account.img.url, {width: 96, height: 96}) %>
    <label for="accountImageFile">
      + 画像を選択
      <%= f.file_field :img, accept: '.jpg,.jpeg,.gif,.png,image/gif,image/jpeg,image/png', id: 'accountImageFile'  %>
    </label>
  </div>
</div>
<div id="accountInfo">
  <div class="name row">
    <div class="col-lg-12">
      <h5>名前</h5>
      <%= f.text_field :user_name %>
    </div>
  </div>
  <div class="submit row">
    <%= f.submit '更新', class: 'custom-btn' %>
  </div>
</div>
<% end %>

<script>
$(function(){
  function readImage(input) {
    if ( input.files && input.files[0] ) {
      var FR= new FileReader();
      FR.onload = function(e) {
        $('.trimmed-img').attr( "src", e.target.result );
      }
      FR.readAsDataURL( input.files[0] );
    }
  }

  $("#accountImageFile").change(function(){
    readImage( this );
  });
});
</script>
